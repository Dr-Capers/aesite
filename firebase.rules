rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /launchSignups/{document} {
      allow create: if
        request.auth == null &&
        request.resource.data.keys().hasOnly([
          "email",
          "submittedAt",
          "locale",
          "userAgent",
          "referrer",
          "sourceUrl",
          "deviceType",
          "utm"
        ]) &&
        request.resource.data.email is string &&
        request.resource.data.email.size() > 3 &&
        request.resource.data.email.size() < 320 &&
        request.resource.data.email == request.resource.id;

      allow read, update, delete: if false;
    }
  }
}
